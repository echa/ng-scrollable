/**
 * ngScrollable - Superamazing scrollbars for AngularJS
 * @version 0.1.2 - built on 2015-06-27
 * @link 
 * @license MIT License, Copyright (c) 2015 Alexander Eichhorn <alex@kidtsunami.com>
 */
angular.module("ngScrollable",[]).directive("ngScrollable",["$document","$window","$timeout","$parse",function(a,b,c,d){"use strict";var e={scrollX:"bottom",scrollY:"right",scrollXSlackSpace:0,scrollYSlackSpace:0,wheelSpeed:1,minSliderLength:10,useBothWheelAxes:!1,useKeyboard:!0,updateOnResize:!0};return{restrict:"A",replace:!0,transclude:!0,template:"<div class=\"scrollable\"><div class=\"scrollable-content\" ng-transclude></div><div class='scrollable-bar scrollable-bar-x'><div class='scrollable-slider'></div></div><div class='scrollable-bar scrollable-bar-y'><div class='scrollable-slider'></div></div></div>",link:function(f,g,h){var i,j=angular.extend({},e,f.$eval(h.ngScrollable)),k={window:angular.element(b),content:angular.element(g.children()[0]),barX:angular.element(g.children()[1]),barY:angular.element(g.children()[2]),sliderX:angular.element(angular.element(g.children()[1]).children()[0]),sliderY:angular.element(angular.element(g.children()[2]).children()[0])},l=!1,m=!1,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=null,y=null,z=null,A=null,B=!1,C=!1,D=!1,E={},F=function(a){return a.toFixed(3)+"px"},G=function(a,b,c){return Math.max(b,Math.min(a,c))},H=function(){var a;l?(t=Math.max(j.minSliderLength,parseInt(n*n/p,10)),u=parseInt(s*(n-t)/(p-n),10),u>=n-t?u=n-t:0>u&&(u=0),a="translate("+F(u)+",0)",k.sliderX.css({transform:a,"-webkit-transform":a,width:F(t)})):(t=u=0,a="translate(0,0)",k.sliderX.css({transform:a,"-webkit-transform":a,width:0}))},I=function(){var a;m?(v=Math.max(j.minSliderLength,parseInt(o*o/q,10)),w=parseInt(r*(o-v)/(q-o),10),w>=o-v?w=o-v:0>w&&(w=0),a="translate(0,"+F(w)+")",k.sliderY.css({transform:a,"-webkit-transform":a,height:F(v)})):(w=v=0,a="translate(0,0)",k.sliderY.css({transform:a,"-webkit-transform":a,height:0}))},J=function(){var a={left:0,width:F(n),display:l?"inherit":"none"};switch(j.scrollX){case"bottom":a.bottom=0,k.content[l?"addClass":"removeClass"]("scrollable-bottom");break;case"top":a.top=0,k.content[l?"addClass":"removeClass"]("scrollable-top")}k.barX.css(a)},K=function(){var a={top:0,height:F(o),display:m?"inherit":"none"};switch(j.scrollY){case"right":a.right=0,k.content[m?"addClass":"removeClass"]("scrollable-right");break;case"left":a.left=0,k.content[m?"addClass":"removeClass"]("scrollable-left")}k.barY.css(a)},L=function(a,b){r=G(b,0,q-o),s=G(a,0,p-n);var c="translate("+F(-s)+","+F(-r)+")";k.content.css({transform:c,"-webkit-transform":c}),E.spyX&&E.spyX(f,s),E.spyY&&E.spyY(f,r)},M=function(a){L(a,r),H()},N=function(a){L(s,a),I()},O=function(){n=g[0].offsetWidth,o=g[0].offsetHeight,p=k.content[0].scrollWidth,q=k.content[0].scrollHeight,"none"!==j.scrollX&&p>n+j.scrollXSlackSpace?l=!0:(l=!1,M(0)),"none"!==j.scrollY&&q>o+j.scrollYSlackSpace?m=!0:(m=!1,N(0)),J(),K(),H(),I()},P=function(a,b){a.stopPropagation(),b&&a.preventDefault()},Q=function(a){y=a.pageX,x=s,B=!0,g.addClass("active"),P(a,!0)},R=function(a){if(B){var b=a.pageX-y,c=parseInt(b*(p-n)/(n-t),10);M(x+c),P(a,!0)}},S=function(a){B&&(B=!1,g.removeClass("active"),x=y=null)},T=function(a){A=a.pageY,z=r,C=!0,g.addClass("active"),P(a,!0)},U=function(a){if(C){var b=a.pageY-A,c=parseInt(b*(q-o)/(o-v),10);N(z+c),P(a,!0)}},V=function(a){C&&(C=!1,g.removeClass("active"),z=A=null)},W=function(a){var b=parseInt(t/2,10),c=a.clientX-k.barX[0].getBoundingClientRect().left-b,d=n-t,e=G(c/d,0,1);M((p-n)*e)},X=function(a){var b=parseInt(v/2,10),c=a.clientY-k.barY[0].getBoundingClientRect().top-b,d=o-v,e=G(c/d,0,1);N((q-o)*e)},Y=function(){D=!0},Z=function(){D=!1},$=function(b){var c=0,d=0,e=30;if(!(!D||a[0].activeElement.isContentEditable||b.altKey||b.ctrlKey||b.metaKey)){switch(b.which){case 37:c=-e;break;case 38:d=e;break;case 39:c=e;break;case 40:d=-e;break;case 33:d=o;break;case 34:d=-o;break;case 35:m&&!l?d=-q:c=o;break;case 36:m&&!l?d=q:c=-o;break;default:return}N(r-d),M(s+c),b.preventDefault()}},_=function(a){a=a.originalEvent||a;var b=(angular.isDefined(a.wheelDeltaX)?-a.wheelDeltaX:a.deltaX)*j.wheelSpeed,d=(angular.isDefined(a.wheelDeltaY)?-a.wheelDeltaY:a.deltaY)*j.wheelSpeed;g.addClass("active"),c.cancel(i),i=c(function(){g.removeClass("active")},500),j.useBothWheelAxes?m&&!l?N(d?r+d:r+b):l&&!m&&M(b?s+b:s+d):(N(r+d),M(s+b)),O(),P(a,!0)};angular.forEach(["spyX","spyY"],function(a){h[a]&&(E[a]=d(h[a]).assign,f.$watch(h[a],function(b){switch(a){case"spyX":M(b);break;case"spyY":N(b)}}))}),O(),f.$on("content.changed",function(){c(function(){k.content=angular.element(g.children()[0]),O()})}),f.$on("scrollable.scroll.left",function(){c(function(){M(0)})}),f.$on("scrollable.scroll.right",function(){c(function(){M(p)})}),f.$on("scrollable.scroll.top",function(){c(function(){N(0)})}),f.$on("scrollable.scroll.bottom",function(){c(function(){N(q)})}),j.updateOnResize&&k.window.on("resize",O),k.sliderX.on("click",P),k.barX.on("click",W),k.sliderY.on("click",P),k.barY.on("click",X),k.sliderX.on("mousedown",Q),a.on("mousemove",R),a.on("mouseup",S),k.sliderY.on("mousedown",T),a.on("mousemove",U),a.on("mouseup",V),j.useKeyboard&&(g.on("mouseenter",Y),g.on("mouseleave",Z),a.on("keydown",$)),g.on("wheel",_),g.on("mousewheel",_),f.$on("$destroy",function(){c.cancel(i),j.updateOnResize&&k.window.off("resize",O),k.sliderX.off("click",P),k.barX.off("click",W),k.sliderY.off("click",P),k.barY.off("click",X),k.sliderX.off("mousedown",Q),a.off("mousemove",R),a.off("mouseup",S),k.sliderY.off("mousedown",T),a.off("mousemove",U),a.off("mouseup",V),j.useKeyboard&&(g.off("mouseenter",Y),g.off("mouseleave",Z),a.off("keydown",$)),g.off("wheel",_),g.off("mousewheel",_)})}}}]);