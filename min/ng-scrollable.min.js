/**
 * ngScrollable - Superamazing scrollbars for AngularJS
 * @version 0.2.1 - built on 2015-08-13
 * @link https://echa.github.io/ng-scrollable/
 * @license MIT License, Copyright (c) 2015 Alexander Eichhorn <alex@kidtsunami.com>
 */
angular.module("ngScrollable",[]).directive("ngScrollable",["$injector",function(a){"use strict";var b=a.get("$document"),c=a.get("$interval"),d=a.get("$timeout"),e=a.get("$window"),f=a.get("$parse"),g=angular.extend,h=angular.element,i=(angular.isDefined,"undefined"!=typeof e.ontouchstart),j="transform",k=e.requestAnimationFrame||e.webkitRequestAnimationFrame;["webkit","moz","o","ms"].every(function(a){var c=a+"Transform",d=b.find("body").eq(0);return"undefined"!=typeof d[0].style[c]?(j=c,!1):!0});var l={id:0,scrollX:"bottom",scrollY:"right",scrollXSlackSpace:0,scrollYSlackSpace:0,scrollXAlways:!1,scrollYAlways:!1,usePadding:!1,wheelSpeed:1,minSliderLength:10,useBothWheelAxes:!1,useKeyboard:!0,updateOnResize:!0,kineticTau:325,updateContentPosition:!0};return{restrict:"A",transclude:!0,template:"<div class=\"scrollable\"><div class=\"scrollable-content\" ng-transclude></div><div class='scrollable-bar scrollable-bar-x'><div class='scrollable-slider'></div></div><div class='scrollable-bar scrollable-bar-y'><div class='scrollable-slider'></div></div></div>",link:function(a,m,n){var o,p,q,r=g({},l,a.$eval(n.ngScrollable)),s=h(m.children()[0]),t={window:h(e),el:s,content:h(s.children()[0]),barX:h(s.children()[1]),barY:h(s.children()[2]),sliderX:h(h(s.children()[1]).children()[0]),sliderY:h(h(s.children()[2]).children()[0])},u=!1,v=!1,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=null,J=null,K=null,L=null,M=!1,N=!1,O=!1,P={},Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=function(a){return a.toFixed(3)+"px"},Z=function(a,b,c){return Math.max(b,Math.min(a,c))},$=function(){var a=w-3;u?(E=Math.max(r.minSliderLength,parseInt(a*a/y,10)),F=parseInt(D*(a-E)/(y-a),10),F>=a-E?F=a-E:0>F&&(F=0),t.sliderX[0].style[j]="translate3d("+Y(F)+",0,0)",t.sliderX[0].style.width=Y(E)):(E=F=0,t.sliderX[0].style[j]="translate3d(0,0,0)",t.sliderX[0].style.width="0")},_=function(){var a=x-3;v?(G=Math.max(r.minSliderLength,parseInt(a*a/z,10)),H=parseInt(C*(a-G)/(z-a),10),H>=a-G?H=a-G:0>H&&(H=0),t.sliderY[0].style[j]="translate3d(0,"+Y(H)+",0)",t.sliderY[0].style.height=Y(G)):(H=G=0,t.sliderY[0].style[j]="translate3d(0,0,0)",t.sliderY[0].style.height="0")},aa=function(){var a=r.scrollXAlways,b={left:0,width:Y(w),display:u||a?"inherit":"none"};switch(r.scrollX){case"bottom":b.bottom=0,t.content[u||a?"addClass":"removeClass"]("scrollable-bottom"),t.barX[u||a?"addClass":"removeClass"]("scrollable-bottom");break;case"top":b.top=0,t.content[u||a?"addClass":"removeClass"]("scrollable-top"),t.barX[u||a?"addClass":"removeClass"]("scrollable-top")}t.barX.css(b),t.sliderX[0].style.display=u?"inherit":"none"},ba=function(){var a=r.scrollYAlways,b={top:0,height:Y(x),display:v||a?"inherit":"none"};switch(r.scrollY){case"right":b.right=0,t.content[v||a?"addClass":"removeClass"]("scrollable-right"),t.barY[v||a?"addClass":"removeClass"]("scrollable-right");break;case"left":b.left=0,t.content[v||a?"addClass":"removeClass"]("scrollable-left"),t.barY[v||a?"addClass":"removeClass"]("scrollable-left")}t.barY.css(b),t.sliderY[0].style.display=v?"inherit":"none"},ca=function(b,c){C=Z(c,0,z-x),D=Z(b,0,y-w),r.updateContentPosition&&(t.content[0].style[j]="translate3d("+Y(-D)+","+Y(-C)+",0)"),P.spyX&&P.spyX(a,parseInt(D,10)),P.spyY&&P.spyY(a,parseInt(C,10)),P.spyCustomContentHeight&&P.spyCustomContentHeight(a,parseInt(B)),P.spyCustomContentWidth&&P.spyCustomContentWidth(a,parseInt(A))},da=function(a){u&&(ca(a,C),$())},ea=function(a){v&&(ca(D,a),_())},fa=function(b,c){w=r.usePadding?t.el[0].clientWidth:t.el[0].offsetWidth,x=r.usePadding?t.el[0].clientHeight:t.el[0].offsetHeight,y=angular.isDefined(A)?A:t.content[0].scrollWidth,z=angular.isDefined(B)?B:t.content[0].scrollHeight,"none"!==r.scrollX&&y>w+r.scrollXSlackSpace?u=!0:(u=!1,da(0)),"none"!==r.scrollY&&z>x+r.scrollYSlackSpace?v=!0:(v=!1,ea(0)),aa(),ba(),$(),_(),c||a.$broadcast("scrollable.dimensions",w,x,y,z,r.id)},ga=function(a,b){return a.stopPropagation(),b&&a.preventDefault(),!1},ha=function(a){return a=a.originalEvent||a,a.targetTouches&&a.targetTouches.length>=1?a.targetTouches[0].pageY:a.pageY},ia=function(a){return a=a.originalEvent||a,a.targetTouches&&a.targetTouches.length>=1?a.targetTouches[0].pageX:a.pageX},ja=function(){var a,b,c,d;a=Date.now(),b=a-p,p=a,c=D-S,S=D,d=1e3*c/(1+b),Q=.8*d+.2*Q,c=C-W,W=C,d=1e3*c/(1+b),U=.8*d+.2*U},ka=function(){var a,b;R&&(a=Date.now()-p,b=-R*Math.exp(-a/r.kineticTau),b>.5||-.5>b?(da(T+b),k(ka)):da(T))},la=function(){var a,b;V&&(a=Date.now()-p,b=-V*Math.exp(-a/r.kineticTau),b>.5||-.5>b?(ea(X+b),k(la)):ea(X))},ma=function(a){return J=ia(a),I=D,M=!0,Q=R=0,S=D,q||(q=c(ja,100)),t.el.addClass("active"),i||ga(a,!i)},na=function(a){if(M){var b=ia(a)-J,c=i?-b:parseInt(b*(y-w)/(w-E),10);return da(I+c),i||ga(a,!0)}},oa=function(a){return M&&(M=!1,t.el.removeClass("active"),I=J=null),q&&(c.cancel(q),q=null),(Q>10||-10>Q)&&(R=.8*Q,T=Math.round(D+R),p=Date.now(),k(ka)),i||ga(a,!i)},pa=function(a){return L=ha(a),K=C,N=!0,U=V=0,W=C,q||(q=c(ja,100)),t.el.addClass("active"),i||ga(a,!i)},qa=function(a){if(N){var b=ha(a)-L,c=i?-b:parseInt(b*(z-x)/(x-G),10);return ea(K+c),i||ga(a,!0)}},ra=function(a){return N&&(N=!1,t.el.removeClass("active"),K=L=null),q&&(c.cancel(q),q=null),(U>10||-10>U)&&(V=.8*U,X=Math.round(C+V),p=Date.now(),k(la)),i||ga(a,!0)},sa=function(b){var c=parseInt(E/2,10),d=b.clientX-t.barX[0].getBoundingClientRect().left-c,e=w-E,f=Z(d/e,0,1);da((y-w)*f),a.$digest()},ta=function(b){var c=parseInt(G/2,10),d=b.clientY-t.barY[0].getBoundingClientRect().top-c,e=x-G,f=Z(d/e,0,1);ea((z-x)*f),a.$digest()},ua=function(){O=!0},va=function(){O=!1},wa=function(c){var d=0,e=0,f=30;if(!(!O||b[0].activeElement.isContentEditable||c.altKey||c.ctrlKey||c.metaKey)){switch(c.which){case 37:d=-f;break;case 38:e=f;break;case 39:d=f;break;case 40:e=-f;break;case 33:e=x;break;case 32:case 34:e=-x;break;case 35:v&&!u?e=-z:d=x;break;case 36:v&&!u?e=z:d=-x;break;default:return}ea(C-e),da(D+d),c.preventDefault(),a.$digest()}},xa=function(b){b=b.originalEvent||b;var c=b.deltaX*r.wheelSpeed,e=b.deltaY*r.wheelSpeed;t.el.addClass("active"),d.cancel(o),o=d(function(){t.el.removeClass("active")},500),r.useBothWheelAxes?v&&!u?ea(e?C+e:C+c):u&&!v&&da(c?D+c:D+e):(ea(C+e),da(D+c)),ga(b,!0),a.$digest()},ya=function(){r.updateOnResize&&t.window.on("resize",fa),"none"!==r.scrollX&&(t.sliderX.on("click",ga),t.barX.on("click",sa),i?(t.el.on("touchstart",ma),t.el.on("touchmove",na),t.el.on("touchend",oa)):(t.sliderX.on("mousedown",ma),b.on("mousemove",na),b.on("mouseup",oa))),"none"!==r.scrollY&&(t.sliderY.on("click",ga),t.barY.on("click",ta),i?(t.el.on("touchstart",pa),t.el.on("touchmove",qa),t.el.on("touchend",ra)):(t.sliderY.on("mousedown",pa),b.on("mousemove",qa),b.on("mouseup",ra))),i||t.el.on("wheel",xa),r.useKeyboard&&!i&&(t.el.on("mouseenter",ua),t.el.on("mouseleave",va),b.on("keydown",wa))},za=function(){r.updateOnResize&&t.window.off("resize",fa),t.sliderX.off("click",ga),t.barX.off("click",sa),t.sliderY.off("click",ga),t.barY.off("click",ta),i?(t.el.off("touchstart",ma),t.el.off("touchmove",na),t.el.off("touchend",oa),t.el.off("touchstart",pa),t.el.off("touchmove",qa),t.el.off("touchend",ra)):(t.sliderX.off("mousedown",ma),b.off("mousemove",na),b.off("mouseup",oa),t.sliderY.off("mousedown",pa),b.off("mousemove",qa),b.off("mouseup",ra),r.useKeyboard&&(t.el.off("mouseenter",ua),t.el.off("mouseleave",va),b.off("keydown",wa)),t.el.off("wheel",xa))};a.$on("content.reload",function(a,b){za(),d(function(){t.el=h(m.children()[0]),t.content=h(t.el.children()[0]),ya(),fa(a,b)})}),a.$on("content.changed",function(a,b,c){b=b||100,d(function(){fa(a,c)},b),a.preventDefault()}),a.$on("scrollable.scroll.left",function(){a.$applyAsync(function(){da(0)})}),a.$on("scrollable.scroll.right",function(){a.$applyAsync(function(){da(y)})}),a.$on("scrollable.scroll.top",function(){a.$applyAsync(function(){ea(0)})}),a.$on("scrollable.scroll.bottom",function(){a.$applyAsync(function(){ea(z)})}),a.$on("$destroy",function(){d.cancel(o),za()}),ya(),fa(),angular.forEach(["spyX","spyY","spyCustomContentHeight","spyCustomContentWidth"],function(b){n[b]&&(P[b]=f(n[b]).assign,a.$watch(n[b],function(a){switch(b){case"spyX":da(a);break;case"spyY":ea(a);break;case"spyCustomContentHeight":B=a,fa(null,null);break;case"spyCustomContentWidth":A=a,fa(null,null)}}))})}}}]);